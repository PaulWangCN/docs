---
title: "会话记忆"
icon: "grid-2-plus"
---

## 功能介绍
作为智能交互的核心引擎，通过分层记忆架构模拟人类记忆存储结构，能够通过持续对话积累用户信息、构建动态画像，并基于此提供高度个性化与连贯性的长期智能服务。

**三层记忆结构**：

- **短期记忆**：记录完整的对话信息，为中长期记忆做准备
- **中期记忆**：用于维持用户多次访问间的服务上下文，并能按主题组织会话脉络
- **长期记忆**：负责沉淀多维护的用户记忆、构建动态更新的用户画像，实现个性化搜索服务。

## 记忆构建
1. 创建记忆体

每个记忆体相当于一个记忆知识库，可以供多个 `Agent` 智能体共同使用。
![](/images/memory/memory_1.png "")
在记忆体创建好之后，需要在实验室自己创建的流程中添加对应的记忆组件，参考提取组件和查询组件

2. 创建记忆标签

用户可以根据智能体的使用场景来配置不同的标签（可以看作用户画像的一部分），可以从记忆片段中根据这些记忆标签提取出用户画像。
![](/images/memory/memory_2.png "")

3. 添加主题/片段

会话被提取成多主题、多片段之后，可以手动进行添加、修改及删除。
![](/images/memory/memory_3.png "")

点击添加分段后
![](/images/memory/memory_4.png "")

## 记忆检索

1. 页面展示

用户会话记录展示
![](/images/memory/memory_5.png "")

主题展示
![](/images/memory/memory_6.png "")

关联的会话记录详情展示，可以通过主题下面的序列号定位到关联处
![](/images/memory/memory_7.png "")

记忆片段展示
![](/images/memory/memory_8.png "")

**用户画像**可以展示用户的画像属性
![](/images/memory/memory_9.png "")

2. 命中测试（与知识中心功能相似）

记忆体内提供了记忆召回测试的功能，用于模拟用户输入问题后调用记忆体内的内容。召回的记忆片段/画像等将按照分数高低进行排序并发送至 `LLM`。一般而言，问题与已提取的记忆的匹配度越高，`LLM` 所输出的答案也就更贴近用户意图。您可以使用不同的检索方式及参数配置，查看召回的内容区块质量与效果。不同的记忆体分段模式对应不同的召回测试方法。

在输入框输入常见的用户问题，点击发送可在右侧的查看召回结果。然后可以选择不同的检索方式，以及输入不同的参数来获取，各参数含义可以参考知识中心检索设置。

![](/images/memory/memory_10.png "")

3. 提示词配置

**提示词分类**

当创建一个新的记忆体的时候，会默认生成这个记忆体对应的一批关于记忆的提示词，包括：
- **记忆决策**：用于判断记忆冲突时该新增、更新还是删除
- **长期记忆提取**：用于提取用户的长期记忆
- **中期记忆汇总**：用于生成用户的多主题记忆
- **标签提取**：用于提取用户的画像
- **会话标题生成**：用于生成会话的标题

![](/images/memory/memory_11.png "")

提示词验证：
左侧选择对应的提示词（可以根据用户的诉求更改保存），然后右侧输入用户问题，验证提示词的准确性、合理性。

![](/images/memory/memory_12.png "")

