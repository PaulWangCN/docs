---
title: 知识检索
icon: "grid"
---

知识库提供文本召回测试功能，用于模拟用户提问后系统从知识库中检索并召回相关文本分段的过程。该功能帮助开发者评估不同分段策略与检索配置下的召回质量，从而优化 `AI` 应用的回答准确性。

当您在测试输入框中提交问题后，系统将根据当前配置的检索方式，在知识库中查找匹配的内容区块，并按相关性得分从高到低排序。这些召回结果将作为上下文输入 `LLM`，直接影响其生成答案的准确性、完整性和可信度。
> 📌 核心原则：问题与召回内容块的匹配度越高，`LLM` 生成的答案越贴近源文档，整体“训练效果”（即 `RAG` 效果）越好。

## 召回测试操作流程
1. 在左侧输入框中输入用户问题；
2. 点击“发送”按钮；
3. 在右侧预览区查看召回结果：
    1. 系统会高亮显示命中的子分段（`Child Chunk`）；
    2. 每个区块右上角显示匹配得分（即子分段与问题的相似度分数）；
    3. 实际发送给 `LLM` 的是该子分段所属的父分段（`Parent Chunk`），以提供完整上下文。
![](/images/kb/kb_index_1.png "")
> 💡 父子分段模式下的优势：
> 关键词精准命中细粒度子分段，确保检索精度；同时通过父分段补充语境，避免信息碎片化。

## 检索设置详解
知识库支持多种检索策略，决定系统如何从文档中提取与用户问题高度相关的信息片段。合理的检索配置是高质量 `RAG` 应用的关键。

### 支持的检索方式
|检索类型|原理说明|适用场景|
|---|---|---|
|**向量检索（语义检索）**|将问题与知识库文本转换为向量，通过计算向量相似度（如余弦距离）匹配语义相近的内容|适合模糊查询、同义替换、多语言或非关键词匹配场景|
|**向量检索（语义检索）**|基于倒排索引，精确匹配问题中的关键词|适合结构化问答、术语明确、需高召回率的场景|
|**混合检索**|同时执行向量检索与全文检索，融合两者结果并重排序|综合语义理解与关键词覆盖，推荐作为默认策略|
> ⚠️ 注意：不同分段模式可能影响可用的检索方式。例如，问答对分段更适配全文检索，而通用文本建议使用向量或混合检索。

### 高级检索参数
|参数|说明|调整建议|
|---|---|---|
|**TopK**|控制最多召回多少个文本分段（按相似度排序）|值过小 → 可能遗漏相关信息<br />值过大 → 引入噪声，增加 LLM 负担<br />建议范围：`3–10`，根据模型上下文窗口动态调整|
|**Score 阈值**|仅召回相似度得分高于此阈值的分段|阈值过高 → 召回数量不足，可能漏检<br />阈值过低 → 引入低相关性内容<br />建议从 `0.5` 开始调试，逐步优化|
|**精排（`Rerank`）**|启用后，使用专用重排序模型对初筛结果二次打分与排序|显著提升排序质量，但增加延迟；高精度场景推荐开启|
|**元数据过滤**|仅检索带有指定元数据（如“部门=客服”、“版本=v2.1”）的文档|提升业务相关性，适用于多租户或多产品线场景|
|**知识图谱检索（默认关闭）**|从知识图谱中检索相关实体、关系及社区报告|适用于需要结构化推理的复杂问答；计算开销较大，按需启用|

## 修改检索方式
点击输入框右上角的 ⚙️ 设置图标，即可切换当前使用的检索方式（向量/全文/混合）并调整上述参数
![](/images/kb/kb_index_2.png "")
建议通过对比测试不同配置下的召回结果，选择最适合您业务场景的组合。

### 召回测试最佳实践
1. **准备测试用例**
- 设计覆盖高频、边缘、模糊等典型用户问题的测试集；
- 包含正向（有答案）、负向（无答案）及多轮对话上下文问题。
2. **选择检索策略**
- 若文档为 `FAQ` 或结构化问答 → 优先尝试全文检索；
- 若文档为长篇说明、技术手册或含同义表达 → 推荐向量检索或混合检索；
- 多语言场景 → 必须使用向量检索（需确保嵌入模型支持多语言）。
3. **调优 `TopK` 与 `Score` 阈值**
- 初始配置建议：`TopK = 5`，`Score = 0.6`；
- 观察召回结果：
    - 若关键信息未被召回 → 降低 `Score` 或提高 `TopK`；
    - 若出现大量无关内容 → 提高 `Score` 或降低 `TopK`；
- 结合 `LLM` 实际输出质量进行端到端验证。
4. **参数配置原则总结**

|参数|过低风险|过高风险|平衡建议|
|---|---|---|---|
|**`TopK`**|信息不全，回答缺失|引入噪声，`Token` 浪费|根据上下文窗口和文档密度动态调整|
|**`Score` 阈值**|召回低质内容，降低准确率|漏检有效信息，回答“不知道”|以 `0.5–0.7` 为起点，结合业务容忍度微调|

> ✅ 提示：召回测试不仅是调试工具，更是持续优化 `RAG` 系统的核心手段。建议在每次知识库更新后重新运行关键测试用例，确保问答质量稳定。

